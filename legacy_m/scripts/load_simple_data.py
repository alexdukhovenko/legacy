#!/usr/bin/env python3
"""
ะัะพััะพะน ะทะฐะณััะทัะธะบ ะดะฐะฝะฝัั ะฑะตะท ัะปะพะถะฝัั ะทะฐะฒะธัะธะผะพััะตะน
"""

import os
import sys
import logging
from pathlib import Path
from datetime import datetime

# ะะพะฑะฐะฒะปัะตะผ ะฟััั ะบ ะฟัะพะตะบัั
project_root = Path(__file__).parent.parent
sys.path.append(str(project_root))

from database.database import SessionLocal
from database.models import QuranVerse, Hadith, OrthodoxText

# ะะฐัััะพะนะบะฐ ะปะพะณะธัะพะฒะฐะฝะธั
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

def load_simple_data():
    """ะะฐะณััะถะฐะตะผ ะฟัะพัััะต ะดะฐะฝะฝัะต ะดะปั ะฒัะตั ะบะพะฝัะตััะธะน"""
    db = SessionLocal()
    try:
        logger.info("๐ ะะฐัะธะฝะฐะตะผ ะทะฐะณััะทะบั ะฟัะพัััั ะดะฐะฝะฝัั...")
        
        # ะัะพะฒะตััะตะผ, ะตััั ะปะธ ัะถะต ะดะฐะฝะฝัะต
        quran_count = db.query(QuranVerse).count()
        hadith_count = db.query(Hadith).count()
        orthodox_count = db.query(OrthodoxText).count()
        
        if quran_count > 0 and hadith_count > 0 and orthodox_count > 0:
            logger.info(f"โ ะะฐะฝะฝัะต ัะถะต ะทะฐะณััะถะตะฝั: {quran_count} ะฐััะพะฒ, {hadith_count} ัะฐะดะธัะพะฒ, {orthodox_count} ะฟัะฐะฒะพัะปะฐะฒะฝัั ัะตะบััะพะฒ")
            return
        
        # ะะฐะณััะถะฐะตะผ ะะพัะฐะฝ
        logger.info("๐ ะะฐะณััะถะฐะตะผ ะะพัะฐะฝ...")
        quran_verses = [
            # ะกัะฝะฝะธััะบะธะต ะฐััั
            QuranVerse(
                surah_number=1, verse_number=1,
                arabic_text="ุจูุณููู ุงูููููู ุงูุฑููุญููููฐูู ุงูุฑููุญูููู",
                translation_ru="ะะพ ะธะผั ะะปะปะฐัะฐ, ะะธะปะพััะธะฒะพะณะพ, ะะธะปะพัะตัะดะฝะพะณะพ!",
                commentary="ะะฐัะฐะปะพ ะบะฐะถะดะพะน ัััั ะะพัะฐะฝะฐ.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=2, verse_number=3,
                arabic_text="ุงูููุฐูููู ููุคูููููููู ุจูุงููุบูููุจู ูููููููููููู ุงูุตููููุงุฉู ูููููููุง ุฑูุฒูููููุงูููู ูููููููููู",
                translation_ru="ะบะพัะพััะต ะฒะตัััั ะฒ ัะพะบัะพะฒะตะฝะฝะพะต, ัะพะฒะตััะฐัั ะฝะฐะผะฐะท ะธ ัะฐััะพะดััั ะธะท ัะพะณะพ, ัะตะผ ะั ะธั ะฝะฐะดะตะปะธะปะธ.",
                commentary="ะะฟะธัะฐะฝะธะต ะบะฐัะตััะฒ ะฑะพะณะพะฑะพัะทะฝะตะฝะฝัั.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=112, verse_number=1,
                arabic_text="ูููู ูููู ุงูููููู ุฃูุญูุฏู",
                translation_ru="ะกะบะฐะถะธ: ยซะะฝ - ะะปะปะฐั ะะดะธะฝัะนยป",
                commentary="ะกััะฐ ะพ ะตะดะธะฝะพะฑะพะถะธะธ.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=2, verse_number=255,
                arabic_text="ุงูููููู ููุง ุฅููููฐูู ุฅููููุง ูููู ุงููุญูููู ุงูููููููููู",
                translation_ru="ะะปะปะฐั - ะฝะตั ะฑะพะถะตััะฒะฐ, ะบัะพะผะต ะะตะณะพ, ะะธะฒะพะณะพ, ะะพะดะดะตัะถะธะฒะฐััะตะณะพ ะถะธะทะฝั.",
                commentary="ะัั ะฐะปั-ะัััะธ - ะพ ะฒะตะปะธัะธะธ ะะปะปะฐัะฐ.",
                confession='sunni'
            ),
            # ะจะธะธััะบะธะต ะฐััั
            QuranVerse(
                surah_number=1, verse_number=1,
                arabic_text="ุจูุณููู ุงูููููู ุงูุฑููุญููููฐูู ุงูุฑููุญูููู",
                translation_ru="ะะพ ะธะผั ะะปะปะฐัะฐ, ะะธะปะพััะธะฒะพะณะพ, ะะธะปะพัะตัะดะฝะพะณะพ!",
                commentary="ะะฐัะฐะปะพ ะบะฐะถะดะพะน ัััั ะะพัะฐะฝะฐ.",
                confession='shia'
            ),
            QuranVerse(
                surah_number=33, verse_number=33,
                arabic_text="ุฅููููููุง ููุฑููุฏู ุงูููููู ููููุฐูููุจู ุนูููููู ุงูุฑููุฌูุณู ุฃููููู ุงููุจูููุชู ููููุทููููุฑููููู ุชูุทููููุฑูุง",
                translation_ru="ะะปะปะฐั ะถะตะปะฐะตั ัะพะปัะบะพ ัะดะฐะปะธัั ัะบะฒะตัะฝั ะพั ะฒะฐั, ะพ ะปัะดะธ ะดะพะผะฐ, ะธ ะพัะธััะธัั ะฒะฐั ะฟะพะปะฝะพัััั.",
                commentary="ะัั ะพ ัะธััะพัะต ะัะปั ะฐะปั-ะะฐะนั.",
                confession='shia'
            ),
            QuranVerse(
                surah_number=5, verse_number=55,
                arabic_text="ุฅููููููุง ููููููููููู ุงูููููู ููุฑูุณูููููู ููุงูููุฐูููู ุขูููููุง ุงูููุฐูููู ูููููููููู ุงูุตููููุงุฉู ููููุคูุชูููู ุงูุฒููููุงุฉู ูููููู ุฑูุงููุนูููู",
                translation_ru="ะะพะธััะธะฝั, ะฒะฐัะธะผ ะฟะพะบัะพะฒะธัะตะปะตะผ ัะฒะปัะตััั ัะพะปัะบะพ ะะปะปะฐั, ะะณะพ ะะพัะปะฐะฝะฝะธะบ ะธ ะฒะตััััะธะต, ะบะพัะพััะต ัะพะฒะตััะฐัั ะฝะฐะผะฐะท, ะฒัะฟะปะฐัะธะฒะฐัั ะทะฐะบัั ะธ ะฟัะตะบะปะพะฝััััั.",
                commentary="ะัั ะพ ะฒะธะปะฐะนะต (ะฟะพะบัะพะฒะธัะตะปัััะฒะต).",
                confession='shia'
            ),
            QuranVerse(
                surah_number=4, verse_number=19,
                arabic_text="ููุนูุงุดูุฑููููููู ุจูุงููููุนูุฑูููู",
                translation_ru="ะะฑัะฐัะฐะนัะตัั ั ะฝะธะผะธ ะฟะพ-ะดะพะฑัะพะผั.",
                commentary="ะ ะดะพะฑัะพะผ ะพะฑัะฐัะตะฝะธะธ ะฒ ัะตะผัะต.",
                confession='shia'
            ),
            QuranVerse(
                surah_number=30, verse_number=21,
                arabic_text="ูููููู ุขููุงุชููู ุฃููู ุฎููููู ููููู ููููู ุฃููููุณููููู ุฃูุฒูููุงุฌูุง ูููุชูุณููููููุง ุฅูููููููุง ููุฌูุนููู ุจูููููููู ูููููุฏููุฉู ููุฑูุญูููุฉู",
                translation_ru="ะ ะธะท ะะณะพ ะทะฝะฐะผะตะฝะธะน - ัะพ, ััะพ ะะฝ ัะพะทะดะฐะป ะดะปั ะฒะฐั ะธะท ะฒะฐั ัะฐะผะธั ะถะตะฝ, ััะพะฑั ะฒั ะฝะฐัะพะดะธะปะธ ะฒ ะฝะธั ะฟะพะบะพะน, ะธ ัััะฐะฝะพะฒะธะป ะผะตะถะดั ะฒะฐะผะธ ะปัะฑะพะฒั ะธ ะผะธะปะพัะตัะดะธะต.",
                commentary="ะ ะปัะฑะฒะธ ะธ ะผะธะปะพัะตัะดะธะธ ะฒ ัะตะผัะต.",
                confession='shia'
            )
        ]
        db.add_all(quran_verses)
        db.flush()  # ะัะธะฝัะดะธัะตะปัะฝะพ ัะพััะฐะฝัะตะผ ะฒ ะฑะฐะทั
        logger.info(f"โ ะะพะฑะฐะฒะปะตะฝะพ {len(quran_verses)} ะฐััะพะฒ ะะพัะฐะฝะฐ")
        
        # ะะฐะณััะถะฐะตะผ ัะฐะดะธัั
        logger.info("๐ ะะฐะณััะถะฐะตะผ ัะฐะดะธัั...")
        hadiths = [
            # ะกัะฝะฝะธััะบะธะต ัะฐะดะธัั
            Hadith(
                collection="ะััะฐัะธ",
                hadith_number=1,
                arabic_text="ุฅููุง ุงูุฃุนูุงู ุจุงูููุงุช",
                translation_ru="ะะพะธััะธะฝะต, ะดะตะปะฐ (ะพัะตะฝะธะฒะฐัััั) ัะพะปัะบะพ ะฟะพ ะฝะฐะผะตัะตะฝะธัะผ.",
                commentary="ะะดะธะฝ ะธะท ัะฐะผัั ะฒะฐะถะฝัั ัะฐะดะธัะพะฒ ะฒ ะธัะปะฐะผะต.",
                confession='sunni'
            ),
            Hadith(
                collection="ะััะฐัะธ",
                hadith_number=2,
                arabic_text="ูู ุญุณู ุฅุณูุงู ุงููุฑุก ุชุฑูู ูุง ูุง ูุนููู",
                translation_ru="ะัะธะทะฝะฐะบะพะผ ัะพัะพัะตะณะพ ะธัะปะฐะผะฐ ัะตะปะพะฒะตะบะฐ ัะฒะปัะตััั ัะพ, ััะพ ะพะฝ ะพััะฐะฒะปัะตั ัะพ, ััะพ ะตะณะพ ะฝะต ะบะฐัะฐะตััั.",
                commentary="ะ ะฒะฐะถะฝะพััะธ ะฝะตะฒะผะตัะฐัะตะปัััะฒะฐ ะฒ ััะถะธะต ะดะตะปะฐ.",
                confession='sunni'
            ),
            Hadith(
                collection="ะััะปะธะผ",
                hadith_number=1,
                arabic_text="ูุง ูุคูู ุฃุญุฏูู ุญุชู ูุญุจ ูุฃุฎูู ูุง ูุญุจ ูููุณู",
                translation_ru="ะะต ัะฒะตััะตั ะฝะธะบัะพ ะธะท ะฒะฐั, ะฟะพะบะฐ ะฝะต ะฑัะดะตั ะถะตะปะฐัั ัะฒะพะตะผั ะฑัะฐัั ัะพะณะพ ะถะต, ัะตะณะพ ะถะตะปะฐะตั ัะตะฑะต.",
                commentary="ะ ะปัะฑะฒะธ ะบ ะฑะปะธะถะฝะตะผั.",
                confession='sunni'
            ),
            # ะจะธะธััะบะธะต ัะฐะดะธัั
            Hadith(
                collection="ะะปั-ะะฐัะธ",
                hadith_number=1,
                arabic_text="ุนู ุฃุจู ุนุจุฏ ุงููู ุนููู ุงูุณูุงู ูุงู: ุฏุนุงุฆู ุงูููุฑ ุซูุงุซุฉ: ุงูุญุฑุต ูุงูุงุณุชูุจุงุฑ ูุงูุญุณุฏ",
                translation_ru="ะั ะะฑั ะะฑะดัะปะปะฐัะฐ (ะผะธั ะตะผั) ะฟะตัะตะดะฐะฝะพ: ะกัะพะปะฟะพะฒ ะฝะตะฒะตัะธั ััะธ: ะฐะปัะฝะพััั, ะฒััะพะบะพะผะตัะธะต ะธ ะทะฐะฒะธััั.",
                commentary="ะัะฝะพะฒั ะฝะตะฒะตัะธั ะฒ ัะธะธััะบะพะผ ะธัะปะฐะผะต.",
                confession='shia'
            ),
            Hadith(
                collection="ะะปั-ะะฐัะธ",
                hadith_number=2,
                arabic_text="ุนู ุงูุฅูุงู ุงูุตุงุฏู ุนููู ุงูุณูุงู: ุฅู ุงููู ุนุฒ ูุฌู ุฎูู ุงูุนูู ููุงู ูู: ุฃูุจู ูุฃูุจูุ ููุงู ูู: ุฃุฏุจุฑ ูุฃุฏุจุฑ",
                translation_ru="ะั ะะผะฐะผะฐ ะกะฐะดัะบะฐ (ะผะธั ะตะผั): ะะพะธััะธะฝะต, ะะปะปะฐั ัะพะทะดะฐะป ัะฐะทัะผ ะธ ัะบะฐะทะฐะป ะตะผั: 'ะัะธะดะธ', ะธ ะพะฝ ะฟัะธัะตะป, ะธ ัะบะฐะทะฐะป: 'ะฃะนะดะธ', ะธ ะพะฝ ััะตะป.",
                commentary="ะ ะฒะฐะถะฝะพััะธ ัะฐะทัะผะฐ ะฒ ะธัะปะฐะผะต.",
                confession='shia'
            ),
            Hadith(
                collection="ะะปั-ะะฐัะธ",
                hadith_number=3,
                arabic_text="ุนู ุงูุฅูุงู ุนูู ุนููู ุงูุณูุงู: ุงููุงุณ ุซูุงุซุฉ: ุนุงูู ุฑุจุงููุ ููุชุนูู ุนูู ุณุจูู ูุฌุงุฉุ ูููุฌ ุฑุนุงุน",
                translation_ru="ะั ะะผะฐะผะฐ ะะปะธ (ะผะธั ะตะผั): ะัะดะธ ะดะตะปัััั ะฝะฐ ััะธ ะบะฐัะตะณะพัะธะธ: ะฑะพะถะตััะฒะตะฝะฝัะน ััะตะฝัะน, ััะตะฝะธะบ ะฝะฐ ะฟััะธ ัะฟะฐัะตะฝะธั, ะธ ะฝะตะฒะตะถะตััะฒะตะฝะฝะฐั ัะพะปะฟะฐ.",
                commentary="ะ ะบะฐัะตะณะพัะธัั ะปัะดะตะน ะฟะพ ะทะฝะฐะฝะธัะผ.",
                confession='shia'
            ),
            Hadith(
                collection="ะะปั-ะะฐัะธ",
                hadith_number=4,
                arabic_text="ุนู ุงูุฅูุงู ุงูุตุงุฏู ุนููู ุงูุณูุงู: ุฃุญุจ ุงูุฃุนูุงู ุฅูู ุงููู ุนุฒ ูุฌู ุฅุฏุฎุงู ุงูุณุฑูุฑ ุนูู ุงููุคูู",
                translation_ru="ะั ะะผะฐะผะฐ ะกะฐะดัะบะฐ (ะผะธั ะตะผั): ะกะฐะผะพะต ะปัะฑะธะผะพะต ะะปะปะฐัะพะผ ะดะตะปะพ - ััะพ ัะฐะดะพะฒะฐัั ะฒะตััััะตะณะพ.",
                commentary="ะ ะฒะฐะถะฝะพััะธ ัะฐะดะพะฒะฐัั ะดััะณะธั ะธ ัะตัะฐัั ะฟัะพะฑะปะตะผั ะผะธัะฝะพ.",
                confession='shia'
            ),
            Hadith(
                collection="ะะปั-ะะฐัะธ",
                hadith_number=5,
                arabic_text="ุนู ุงูุฅูุงู ุนูู ุนููู ุงูุณูุงู: ุงูุตุจุฑ ูุตู ุงูุฅููุงู",
                translation_ru="ะั ะะผะฐะผะฐ ะะปะธ (ะผะธั ะตะผั): ะขะตัะฟะตะฝะธะต - ััะพ ะฟะพะปะพะฒะธะฝะฐ ะฒะตัั.",
                commentary="ะ ะฒะฐะถะฝะพััะธ ัะตัะฟะตะฝะธั ะฒ ัะตัะตะฝะธะธ ัะตะผะตะนะฝัั ะฟัะพะฑะปะตะผ.",
                confession='shia'
            ),
            Hadith(
                collection="ะะปั-ะะฐัะธ",
                hadith_number=6,
                arabic_text="ุนู ุงูุฅูุงู ุงูุตุงุฏู ุนููู ุงูุณูุงู: ุฅู ุงููู ูุญุจ ุงููุญุณููู",
                translation_ru="ะั ะะผะฐะผะฐ ะกะฐะดัะบะฐ (ะผะธั ะตะผั): ะะพะธััะธะฝะต, ะะปะปะฐั ะปัะฑะธั ัะฒะพัััะธั ะดะพะฑัะพ.",
                commentary="ะ ะฒะฐะถะฝะพััะธ ะดะพะฑัะพัั ะธ ะผะธะปะพัะตัะดะธั ะฒ ัะตะผัะต.",
                confession='shia'
            )
        ]
        db.add_all(hadiths)
        db.flush()  # ะัะธะฝัะดะธัะตะปัะฝะพ ัะพััะฐะฝัะตะผ ะฒ ะฑะฐะทั
        logger.info(f"โ ะะพะฑะฐะฒะปะตะฝะพ {len(hadiths)} ัะฐะดะธัะพะฒ")
        
        # ะะฐะณััะถะฐะตะผ ะฟัะฐะฒะพัะปะฐะฒะฝัะต ัะตะบััั
        logger.info("โช ะะฐะณััะถะฐะตะผ ะฟัะฐะฒะพัะปะฐะฒะฝัะต ัะตะบััั...")
        orthodox_texts = [
            OrthodoxText(
                source_type='ะะธะฑะปะธั',
                book_name='ะะฒะฐะฝะณะตะปะธะต ะพั ะะฐััะตั',
                chapter_number=6,
                verse_number=9,
                original_text='ะััะต ะฝะฐั, ัััะธะน ะฝะฐ ะฝะตะฑะตัะฐั! ะดะฐ ัะฒััะธััั ะธะผั ะขะฒะพะต;',
                translation_ru='ะััะต ะฝะฐั, ัััะธะน ะฝะฐ ะฝะตะฑะตัะฐั! ะดะฐ ัะฒััะธััั ะธะผั ะขะฒะพะต;',
                commentary='ะะฐัะฐะปะพ ะผะพะปะธัะฒั ะะพัะฟะพะดะฝะตะน.',
                theme='ะะพะปะธัะฒะฐ',
                confession='orthodox'
            ),
            OrthodoxText(
                source_type='ะะธะฑะปะธั',
                book_name='ะะพัะปะฐะฝะธะต ะบ ะะฒัะตัะผ',
                chapter_number=11,
                verse_number=1,
                original_text='ะะตัะฐ ะถะต ะตััั ะพัััะตััะฒะปะตะฝะธะต ะพะถะธะดะฐะตะผะพะณะพ ะธ ัะฒะตัะตะฝะฝะพััั ะฒ ะฝะตะฒะธะดะธะผะพะผ.',
                translation_ru='ะะตัะฐ ะถะต ะตััั ะพัััะตััะฒะปะตะฝะธะต ะพะถะธะดะฐะตะผะพะณะพ ะธ ัะฒะตัะตะฝะฝะพััั ะฒ ะฝะตะฒะธะดะธะผะพะผ.',
                commentary='ะะฟัะตะดะตะปะตะฝะธะต ะฒะตัั ะฒ ััะธััะธะฐะฝััะฒะต.',
                theme='ะะตัะฐ',
                confession='orthodox'
            ),
            OrthodoxText(
                source_type='ะกะฒััะพะพัะตัะตัะบะธะต ัััะดั',
                book_name='ะะตััะฒะธัะฐ',
                author='ะัะตะฟะพะดะพะฑะฝัะน ะะพะฐะฝะฝ ะะตััะฒะธัะฝะธะบ',
                chapter_number=28,
                verse_number=1,
                original_text='ะะพะปะธัะฒะฐ ะตััั ะฒะพะทะฝะพัะตะฝะธะต ัะผะฐ ะบ ะะพะณั.',
                translation_ru='ะะพะปะธัะฒะฐ ะตััั ะฒะพะทะฝะพัะตะฝะธะต ัะผะฐ ะบ ะะพะณั.',
                commentary='ะัะฐัะบะพะต ะพะฟัะตะดะตะปะตะฝะธะต ะผะพะปะธัะฒั.',
                theme='ะะพะปะธัะฒะฐ',
                confession='orthodox'
            )
        ]
        db.add_all(orthodox_texts)
        db.flush()  # ะัะธะฝัะดะธัะตะปัะฝะพ ัะพััะฐะฝัะตะผ ะฒ ะฑะฐะทั
        logger.info(f"โ ะะพะฑะฐะฒะปะตะฝะพ {len(orthodox_texts)} ะฟัะฐะฒะพัะปะฐะฒะฝัั ัะตะบััะพะฒ")
        
        db.commit()
        logger.info(f"โ ะะฐะณััะถะตะฝะพ: {len(quran_verses)} ะฐััะพะฒ, {len(hadiths)} ัะฐะดะธัะพะฒ, {len(orthodox_texts)} ะฟัะฐะฒะพัะปะฐะฒะฝัั ัะตะบััะพะฒ")
        
    except Exception as e:
        logger.error(f"โ ะัะธะฑะบะฐ ะทะฐะณััะทะบะธ ะดะฐะฝะฝัั: {e}")
        db.rollback()
        raise
    finally:
        db.close()

if __name__ == "__main__":
    load_simple_data()

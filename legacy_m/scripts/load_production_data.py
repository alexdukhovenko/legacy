#!/usr/bin/env python3
"""
ะกะบัะธะฟั ะดะปั ะทะฐะณััะทะบะธ ะดะฐะฝะฝัั ะฒ ะฟัะพะดะฐะบัะตะฝะต
ะะฐะณััะถะฐะตั ะดะฐะฝะฝัะต ะธะท ะฒะฝะตัะฝะธั ะธััะพัะฝะธะบะพะฒ ะธะปะธ ัะพะทะดะฐะตั ัะฐััะธัะตะฝะฝัะต ะฟัะธะผะตัะฝัะต ะดะฐะฝะฝัะต
"""

import os
import sys
import logging
from pathlib import Path
from datetime import datetime
import requests
from sqlalchemy.orm import Session

# ะะพะฑะฐะฒะปัะตะผ ะฟััั ะบ ะฟัะพะตะบัั
project_root = Path(__file__).parent.parent
sys.path.append(str(project_root))

from database.database import SessionLocal
from database.models import QuranVerse, Hadith, Commentary, OrthodoxText, OrthodoxDocument

# ะะฐัััะพะนะบะฐ ะปะพะณะธัะพะฒะฐะฝะธั
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

class ProductionDataLoader:
    """ะะฐะณััะทัะธะบ ะดะฐะฝะฝัั ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ"""
    
    def __init__(self):
        self.db = SessionLocal()
        self.loaded_count = 0
    
    def load_extended_sample_data(self):
        """ะะฐะณััะถะฐะตั ัะฐััะธัะตะฝะฝัะต ะฟัะธะผะตัะฝัะต ะดะฐะฝะฝัะต"""
        logger.info("๐ ะะฐะณััะถะฐะตะผ ัะฐััะธัะตะฝะฝัะต ะฟัะธะผะตัะฝัะต ะดะฐะฝะฝัะต...")
        
        # ะะฐะณััะถะฐะตะผ ัะฐััะธัะตะฝะฝัะต ะดะฐะฝะฝัะต ะะพัะฐะฝะฐ
        self._load_extended_quran_data()
        
        # ะะฐะณััะถะฐะตะผ ัะฐััะธัะตะฝะฝัะต ัะฐะดะธัั
        self._load_extended_hadith_data()
        
        # ะะฐะณััะถะฐะตะผ ัะฐััะธัะตะฝะฝัะต ะฟัะฐะฒะพัะปะฐะฒะฝัะต ัะตะบััั
        self._load_extended_orthodox_data()
        
        logger.info(f"โ ะะฐะณััะถะตะฝะพ {self.loaded_count} ะทะฐะฟะธัะตะน")
    
    def _load_extended_quran_data(self):
        """ะะฐะณััะถะฐะตั ัะฐััะธัะตะฝะฝัะต ะดะฐะฝะฝัะต ะะพัะฐะฝะฐ"""
        logger.info("๐ ะะฐะณััะถะฐะตะผ ัะฐััะธัะตะฝะฝัะต ะดะฐะฝะฝัะต ะะพัะฐะฝะฐ...")
        
        # ะะฐััะธัะตะฝะฝัะต ะฐััั ะะพัะฐะฝะฐ
        extended_quran_verses = [
            # ะกััะฐ 1 - ะะปั-ะคะฐัะธัะฐ
            QuranVerse(
                surah_number=1, verse_number=1,
                arabic_text="ุจูุณููู ุงูููููู ุงูุฑููุญููููฐูู ุงูุฑููุญูููู",
                translation_ru="ะะพ ะธะผั ะะปะปะฐัะฐ, ะะธะปะพััะธะฒะพะณะพ, ะะธะปะพัะตัะดะฝะพะณะพ!",
                commentary="ะะฐัะฐะปะพ ะบะฐะถะดะพะน ัััั ะะพัะฐะฝะฐ, ะบัะพะผะต ะดะตะฒััะพะน.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=1, verse_number=2,
                arabic_text="ุงููุญูููุฏู ููููููู ุฑูุจูู ุงููุนูุงููููููู",
                translation_ru="ะฅะฒะฐะปะฐ ะะปะปะฐัั, ะะพัะฟะพะดั ะผะธัะพะฒ,",
                commentary="ะัะพัะปะฐะฒะปะตะฝะธะต ะะปะปะฐัะฐ ะบะฐะบ ะขะฒะพััะฐ ะฒัะตะณะพ ัััะตะณะพ.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=1, verse_number=3,
                arabic_text="ุงูุฑููุญููููฐูู ุงูุฑููุญูููู",
                translation_ru="ะะธะปะพััะธะฒะพะผั, ะะธะปะพัะตัะดะฝะพะผั,",
                commentary="ะะพะดัะตัะบะธะฒะฐะฝะธะต ะผะธะปะพััะธ ะธ ะผะธะปะพัะตัะดะธั ะะปะปะฐัะฐ.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=1, verse_number=4,
                arabic_text="ููุงูููู ูููููู ุงูุฏููููู",
                translation_ru="ะะปะฐะดัะบะต ะะฝั ะฒะพะทะดะฐัะฝะธั!",
                commentary="ะะปะปะฐั - ะตะดะธะฝััะฒะตะฝะฝัะน ััะดัั ะฒ ะกัะดะฝัะน ะดะตะฝั.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=1, verse_number=5,
                arabic_text="ุฅููููุงูู ููุนูุจูุฏู ููุฅููููุงูู ููุณูุชูุนูููู",
                translation_ru="ะขะตะฑะต ะพะดะฝะพะผั ะผั ะฟะพะบะปะพะฝัะตะผัั ะธ ะขะตะฑั ะพะดะฝะพะณะพ ะผะพะปะธะผ ะพ ะฟะพะผะพัะธ.",
                commentary="ะัะธะทะฝะฐะฝะธะต ะตะดะธะฝะพะฑะพะถะธั ะธ ะฟัะพััะฑะฐ ะพ ะฟะพะผะพัะธ.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=1, verse_number=6,
                arabic_text="ุงููุฏูููุง ุงูุตููุฑูุงุทู ุงููููุณูุชูููููู",
                translation_ru="ะะตะดะธ ะฝะฐั ะฟััะผัะผ ะฟััะตะผ,",
                commentary="ะัะพััะฑะฐ ะพ ะฝะฐััะฐะฒะปะตะฝะธะธ ะฝะฐ ะฟัะฐะฒะธะปัะฝัะน ะฟััั.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=1, verse_number=7,
                arabic_text="ุตูุฑูุงุทู ุงูููุฐูููู ุฃูููุนูููุชู ุนููููููููู ุบูููุฑู ุงููููุบูุถููุจู ุนููููููููู ููููุง ุงูุถููุงูููููู",
                translation_ru="ะฟััะตะผ ัะตั, ะบะพะณะพ ะขั ะพะฑะปะฐะณะพะดะตัะตะปัััะฒะพะฒะฐะป, ะฝะต ัะตั, ะฝะฐ ะบะพะณะพ ะฟะฐะป ะณะฝะตะฒ, ะธ ะฝะต ะทะฐะฑะปัะดัะธั.",
                commentary="ะัะพััะฑะฐ ัะปะตะดะพะฒะฐัั ะฟััะตะผ ะฟัะฐะฒะตะดะฝะธะบะพะฒ, ะฐ ะฝะต ะทะฐะฑะปัะดัะธั.",
                confession='sunni'
            ),
            
            # ะกััะฐ 2 - ะะปั-ะะฐะบะฐัะฐ
            QuranVerse(
                surah_number=2, verse_number=1,
                arabic_text="ุงูู",
                translation_ru="ะะปะธั. ะัะผ. ะะธะผ.",
                commentary="ะะฐะณะฐะดะพัะฝัะต ะฑัะบะฒั ะฒ ะฝะฐัะฐะปะต ัััั.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=2, verse_number=2,
                arabic_text="ุฐููฐูููู ุงููููุชูุงุจู ููุง ุฑูููุจู  ููููู  ููุฏูู ูููููููุชููููููู",
                translation_ru="ะญัะพ ะะธัะฐะฝะธะต, ะฒ ะบะพัะพัะพะผ ะฝะตั ัะพะผะฝะตะฝะธั, ัะฒะปัะตััั ะฒะตัะฝัะผ ััะบะพะฒะพะดััะฒะพะผ ะดะปั ะฑะพะณะพะฑะพัะทะฝะตะฝะฝัั,",
                commentary="ะะพัะฐะฝ - ััะบะพะฒะพะดััะฒะพ ะดะปั ะฑะพะณะพะฑะพัะทะฝะตะฝะฝัั.",
                confession='sunni'
            ),
            QuranVerse(
                surah_number=2, verse_number=3,
                arabic_text="ุงูููุฐูููู ููุคูููููููู ุจูุงููุบูููุจู ูููููููููููู ุงูุตููููุงุฉู ูููููููุง ุฑูุฒูููููุงูููู ูููููููููู",
                translation_ru="ะบะพัะพััะต ะฒะตัััั ะฒ ัะพะบัะพะฒะตะฝะฝะพะต, ัะพะฒะตััะฐัั ะฝะฐะผะฐะท ะธ ัะฐััะพะดััั ะธะท ัะพะณะพ, ัะตะผ ะั ะธั ะฝะฐะดะตะปะธะปะธ.",
                commentary="ะะฟะธัะฐะฝะธะต ะบะฐัะตััะฒ ะฑะพะณะพะฑะพัะทะฝะตะฝะฝัั.",
                confession='sunni'
            ),
            
            # ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะฐััั ะดะปั ัะธะธัะพะฒ
            QuranVerse(
                surah_number=1, verse_number=1,
                arabic_text="ุจูุณููู ุงูููููู ุงูุฑููุญููููฐูู ุงูุฑููุญูููู",
                translation_ru="ะะพ ะธะผั ะะปะปะฐัะฐ, ะะธะปะพััะธะฒะพะณะพ, ะะธะปะพัะตัะดะฝะพะณะพ!",
                commentary="ะะฐัะฐะปะพ ะบะฐะถะดะพะน ัััั ะะพัะฐะฝะฐ ะฒ ัะธะธััะบะพะน ััะฐะดะธัะธะธ.",
                confession='shia'
            ),
            QuranVerse(
                surah_number=2, verse_number=3,
                arabic_text="ุงูููุฐูููู ููุคูููููููู ุจูุงููุบูููุจู ูููููููููููู ุงูุตููููุงุฉู ูููููููุง ุฑูุฒูููููุงูููู ูููููููููู",
                translation_ru="ะบะพัะพััะต ะฒะตัััั ะฒ ัะพะบัะพะฒะตะฝะฝะพะต, ัะพะฒะตััะฐัั ะฝะฐะผะฐะท ะธ ัะฐััะพะดััั ะธะท ัะพะณะพ, ัะตะผ ะั ะธั ะฝะฐะดะตะปะธะปะธ.",
                commentary="ะะตัะฐ ะฒ ัะพะบัะพะฒะตะฝะฝะพะต ะฒะบะปััะฐะตั ะฒะตัั ะฒ ะธะผะฐะผะฐั ะฒ ัะธะธะทะผะต.",
                confession='shia'
            ),
        ]
        
        for verse in extended_quran_verses:
            # ะัะพะฒะตััะตะผ, ะฝะต ัััะตััะฒัะตั ะปะธ ัะถะต ัะฐะบะพะน ะฐัั
            existing = self.db.query(QuranVerse).filter(
                QuranVerse.surah_number == verse.surah_number,
                QuranVerse.verse_number == verse.verse_number,
                QuranVerse.confession == verse.confession
            ).first()
            
            if not existing:
                self.db.add(verse)
                self.loaded_count += 1
        
        self.db.commit()
        logger.info(f"โ ะะฐะณััะถะตะฝะพ {len(extended_quran_verses)} ะฐััะพะฒ ะะพัะฐะฝะฐ")
    
    def _load_extended_hadith_data(self):
        """ะะฐะณััะถะฐะตั ัะฐััะธัะตะฝะฝัะต ัะฐะดะธัั"""
        logger.info("๐ ะะฐะณััะถะฐะตะผ ัะฐััะธัะตะฝะฝัะต ัะฐะดะธัั...")
        
        extended_hadiths = [
            # ะกัะฝะฝะธััะบะธะต ัะฐะดะธัั
            Hadith(
                collection="ะััะฐัะธ",
                chapter="ะะฐัะฐะปะพ ะัะบัะพะฒะตะฝะธั",
                number=1,
                text_arabic="ุฅููุง ุงูุฃุนูุงู ุจุงูููุงุช",
                text_russian="ะะพะธััะธะฝะต, ะดะตะปะฐ (ะพัะตะฝะธะฒะฐัััั) ัะพะปัะบะพ ะฟะพ ะฝะฐะผะตัะตะฝะธัะผ.",
                commentary="ะะฐะถะฝะพััั ะฝะฐะผะตัะตะฝะธั ะฒ ะธัะปะฐะผะต.",
                confession='sunni'
            ),
            Hadith(
                collection="ะััะฐัะธ",
                chapter="ะะตัะฐ",
                number=2,
                text_arabic="ุจูู ุงูุฅุณูุงู ุนูู ุฎูุณ",
                text_russian="ะัะปะฐะผ ะฟะพัััะพะตะฝ ะฝะฐ ะฟััะธ (ััะพะปะฟะฐั).",
                commentary="ะััั ััะพะปะฟะพะฒ ะธัะปะฐะผะฐ.",
                confession='sunni'
            ),
            Hadith(
                collection="ะััะปะธะผ",
                chapter="ะะตัะฐ",
                number=1,
                text_arabic="ุงูุฅููุงู ุจุถุน ูุณุจุนูู ุดุนุจุฉ",
                text_russian="ะะตัะฐ ะธะผะตะตั ะฑะพะปะตะต ัะตะผะธะดะตัััะธ ะพัะฒะตัะฒะปะตะฝะธะน.",
                commentary="ะะตัะฐ ะฒะบะปััะฐะตั ะฒ ัะตะฑั ะผะฝะพะถะตััะฒะพ ะฐัะฟะตะบัะพะฒ.",
                confession='sunni'
            ),
            Hadith(
                collection="ะััะฐัะธ",
                chapter="ะะพะปะธัะฒะฐ",
                number=1,
                text_arabic="ุงูุตูุงุฉ ุนููุฏ ุงูุฏูู",
                text_russian="ะะพะปะธัะฒะฐ - ััะพะปะฟ ัะตะปะธะณะธะธ.",
                commentary="ะะฐะถะฝะพััั ะผะพะปะธัะฒั ะฒ ะธัะปะฐะผะต.",
                confession='sunni'
            ),
            Hadith(
                collection="ะััะปะธะผ",
                chapter="ะกะตะผัั",
                number=1,
                text_arabic="ุฎูุฑูู ุฎูุฑูู ูุฃููู",
                text_russian="ะัััะธะน ะธะท ะฒะฐั - ัะพั, ะบัะพ ะปัััะต ะฒัะตั ะพัะฝะพัะธััั ะบ ัะฒะพะตะน ัะตะผัะต.",
                commentary="ะะฐะถะฝะพััั ัะพัะพัะตะณะพ ะพัะฝะพัะตะฝะธั ะบ ัะตะผัะต.",
                confession='sunni'
            ),
            
            # ะจะธะธััะบะธะต ัะฐะดะธัั
            Hadith(
                collection="ะะปั-ะะฐัะธ",
                chapter="ะะฝะธะณะฐ ัะฐะทัะผะฐ ะธ ะฝะตะฒะตะถะตััะฒะฐ",
                number=1,
                text_arabic="ุนู ุฃุจู ุนุจุฏ ุงููู ุนููู ุงูุณูุงู ูุงู: ุฏุนุงุฆู ุงูููุฑ ุซูุงุซุฉ: ุงูุญุฑุต ูุงูุงุณุชูุจุงุฑ ูุงูุญุณุฏ",
                text_russian="ะั ะะฑั ะะฑะดัะปะปะฐัะฐ (ะผะธั ะตะผั) ะฟะตัะตะดะฐะฝะพ: ะกัะพะปะฟะพะฒ ะฝะตะฒะตัะธั ััะธ: ะฐะปัะฝะพััั, ะฒััะพะบะพะผะตัะธะต ะธ ะทะฐะฒะธััั.",
                commentary="ะัะฝะพะฒั ะฝะตะฒะตัะธั ะฒ ัะธะธััะบะพะผ ะธัะปะฐะผะต.",
                confession='shia'
            ),
            Hadith(
                collection="ะะปั-ะะฐัะธ",
                chapter="ะะฝะธะณะฐ ะฒะตัั ะธ ะฝะตะฒะตัะธั",
                number=2,
                text_arabic="ุนู ุฃุจู ุฌุนูุฑ ุนููู ุงูุณูุงู ูุงู: ุงูุฅููุงู ูุนุฑูุฉ ุจุงูููุจ ูุฅูุฑุงุฑ ุจุงููุณุงู ูุนูู ุจุงูุฃุฑูุงู",
                text_russian="ะั ะะฑั ะะถะฐัะฐัะฐ (ะผะธั ะตะผั) ะฟะตัะตะดะฐะฝะพ: ะะตัะฐ - ััะพ ะฟะพะทะฝะฐะฝะธะต ัะตัะดัะตะผ, ะฟัะธะทะฝะฐะฝะธะต ัะทัะบะพะผ ะธ ะดะตะนััะฒะธะต ะพัะณะฐะฝะฐะผะธ.",
                commentary="ะะฟัะตะดะตะปะตะฝะธะต ะฒะตัั ะฒ ัะธะธะทะผะต.",
                confession='shia'
            ),
            Hadith(
                collection="ะะปั-ะะฐัะธ",
                chapter="ะะฝะธะณะฐ ะผะพะปะธัะฒั",
                number=1,
                text_arabic="ุนู ุฃุจู ุนุจุฏ ุงููู ุนููู ุงูุณูุงู ูุงู: ุงูุตูุงุฉ ูุฑุจุงู ูู ุชูู",
                text_russian="ะั ะะฑั ะะฑะดัะปะปะฐัะฐ (ะผะธั ะตะผั) ะฟะตัะตะดะฐะฝะพ: ะะพะปะธัะฒะฐ - ะถะตััะฒะพะฟัะธะฝะพัะตะฝะธะต ะบะฐะถะดะพะณะพ ะฑะปะฐะณะพัะตััะธะฒะพะณะพ.",
                commentary="ะะฝะฐัะตะฝะธะต ะผะพะปะธัะฒั ะฒ ัะธะธะทะผะต.",
                confession='shia'
            ),
        ]
        
        for hadith in extended_hadiths:
            # ะัะพะฒะตััะตะผ, ะฝะต ัััะตััะฒัะตั ะปะธ ัะถะต ัะฐะบะพะน ัะฐะดะธั
            existing = self.db.query(Hadith).filter(
                Hadith.collection == hadith.collection,
                Hadith.number == hadith.number,
                Hadith.confession == hadith.confession
            ).first()
            
            if not existing:
                self.db.add(hadith)
                self.loaded_count += 1
        
        self.db.commit()
        logger.info(f"โ ะะฐะณััะถะตะฝะพ {len(extended_hadiths)} ัะฐะดะธัะพะฒ")
    
    def _load_extended_orthodox_data(self):
        """ะะฐะณััะถะฐะตั ัะฐััะธัะตะฝะฝัะต ะฟัะฐะฒะพัะปะฐะฒะฝัะต ัะตะบััั"""
        logger.info("โช ะะฐะณััะถะฐะตะผ ัะฐััะธัะตะฝะฝัะต ะฟัะฐะฒะพัะปะฐะฒะฝัะต ัะตะบััั...")
        
        # ะกะพะทะดะฐะตะผ ัะธะบัะธะฒะฝัะน ะดะพะบัะผะตะฝั
        doc = OrthodoxDocument(
            filename="extended_orthodox_sources.txt",
            title="ะะฐััะธัะตะฝะฝัะต ะฟัะฐะฒะพัะปะฐะฒะฝัะต ะธััะพัะฝะธะบะธ",
            author="ะกะธััะตะผะฐ",
            document_type="ะกะฑะพัะฝะธะบ",
            file_path="/app/data/ะัะฐะฒะพัะปะฐะฒะธะต/extended_sources.txt",
            file_size=1024,
            confession='orthodox',
            processed=1,
            processed_at=datetime.utcnow(),
            pages_count=1
        )
        self.db.add(doc)
        self.db.flush()
        
        extended_orthodox_texts = [
            # ะะธะฑะปะธั
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะธะฑะปะธั',
                book_name='ะะฒะฐะฝะณะตะปะธะต ะพั ะะฐััะตั',
                chapter_number=6,
                verse_number=9,
                original_text='ะััะต ะฝะฐั, ัััะธะน ะฝะฐ ะฝะตะฑะตัะฐั! ะดะฐ ัะฒััะธััั ะธะผั ะขะฒะพะต;',
                translation_ru='ะััะต ะฝะฐั, ัััะธะน ะฝะฐ ะฝะตะฑะตัะฐั! ะดะฐ ัะฒััะธััั ะธะผั ะขะฒะพะต;',
                commentary='ะะฐัะฐะปะพ ะผะพะปะธัะฒั ะะพัะฟะพะดะฝะตะน.',
                theme='ะะพะปะธัะฒะฐ'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะธะฑะปะธั',
                book_name='ะะฒะฐะฝะณะตะปะธะต ะพั ะะฐััะตั',
                chapter_number=6,
                verse_number=10,
                original_text='ะดะฐ ะฟัะธะธะดะตั ะฆะฐัััะฒะธะต ะขะฒะพะต; ะดะฐ ะฑัะดะตั ะฒะพะปั ะขะฒะพั ะธ ะฝะฐ ะทะตะผะปะต, ะบะฐะบ ะฝะฐ ะฝะตะฑะต;',
                translation_ru='ะดะฐ ะฟัะธะธะดะตั ะฆะฐัััะฒะธะต ะขะฒะพะต; ะดะฐ ะฑัะดะตั ะฒะพะปั ะขะฒะพั ะธ ะฝะฐ ะทะตะผะปะต, ะบะฐะบ ะฝะฐ ะฝะตะฑะต;',
                commentary='ะัะพััะฑะฐ ะพ ะฟัะธัะตััะฒะธะธ ะฆะฐัััะฒะฐ ะะพะถะธั.',
                theme='ะะพะปะธัะฒะฐ'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะธะฑะปะธั',
                book_name='ะะพัะปะฐะฝะธะต ะบ ะะฒัะตัะผ',
                chapter_number=11,
                verse_number=1,
                original_text='ะะตัะฐ ะถะต ะตััั ะพัััะตััะฒะปะตะฝะธะต ะพะถะธะดะฐะตะผะพะณะพ ะธ ัะฒะตัะตะฝะฝะพััั ะฒ ะฝะตะฒะธะดะธะผะพะผ.',
                translation_ru='ะะตัะฐ ะถะต ะตััั ะพัััะตััะฒะปะตะฝะธะต ะพะถะธะดะฐะตะผะพะณะพ ะธ ัะฒะตัะตะฝะฝะพััั ะฒ ะฝะตะฒะธะดะธะผะพะผ.',
                commentary='ะะฟัะตะดะตะปะตะฝะธะต ะฒะตัั ะฒ ััะธััะธะฐะฝััะฒะต.',
                theme='ะะตัะฐ'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะธะฑะปะธั',
                book_name='ะะตัะฒะพะต ะฟะพัะปะฐะฝะธะต ะบ ะะพัะธะฝััะฝะฐะผ',
                chapter_number=13,
                verse_number=4,
                original_text='ะัะฑะพะฒั ะดะพะปะณะพัะตัะฟะธั, ะผะธะปะพัะตัะดััะฒัะตั, ะปัะฑะพะฒั ะฝะต ะทะฐะฒะธะดัะตั, ะปัะฑะพะฒั ะฝะต ะฟัะตะฒะพะทะฝะพัะธััั, ะฝะต ะณะพัะดะธััั,',
                translation_ru='ะัะฑะพะฒั ะดะพะปะณะพัะตัะฟะธั, ะผะธะปะพัะตัะดััะฒัะตั, ะปัะฑะพะฒั ะฝะต ะทะฐะฒะธะดัะตั, ะปัะฑะพะฒั ะฝะต ะฟัะตะฒะพะทะฝะพัะธััั, ะฝะต ะณะพัะดะธััั,',
                commentary='ะะฟะธัะฐะฝะธะต ัะฒะพะนััะฒ ััะธััะธะฐะฝัะบะพะน ะปัะฑะฒะธ.',
                theme='ะัะฑะพะฒั'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะธะฑะปะธั',
                book_name='ะะฒะฐะฝะณะตะปะธะต ะพั ะะพะฐะฝะฝะฐ',
                chapter_number=3,
                verse_number=16,
                original_text='ะะฑะพ ัะฐะบ ะฒะพะทะปัะฑะธะป ะะพะณ ะผะธั, ััะพ ะพัะดะฐะป ะกัะฝะฐ ะกะฒะพะตะณะพ ะะดะธะฝะพัะพะดะฝะพะณะพ, ะดะฐะฑั ะฒััะบะธะน, ะฒะตััััะธะน ะฒ ะะตะณะพ, ะฝะต ะฟะพะณะธะฑ, ะฝะพ ะธะผะตะป ะถะธะทะฝั ะฒะตัะฝัั.',
                translation_ru='ะะฑะพ ัะฐะบ ะฒะพะทะปัะฑะธะป ะะพะณ ะผะธั, ััะพ ะพัะดะฐะป ะกัะฝะฐ ะกะฒะพะตะณะพ ะะดะธะฝะพัะพะดะฝะพะณะพ, ะดะฐะฑั ะฒััะบะธะน, ะฒะตััััะธะน ะฒ ะะตะณะพ, ะฝะต ะฟะพะณะธะฑ, ะฝะพ ะธะผะตะป ะถะธะทะฝั ะฒะตัะฝัั.',
                commentary='ะัะฑะพะฒั ะะพะถะธั ะบ ะผะธัั.',
                theme='ะัะฑะพะฒั'
            ),
            
            # ะกะฒััะพะพัะตัะตัะบะธะต ัััะดั
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะกะฒััะพะพัะตัะตัะบะธะต ัััะดั',
                book_name='ะะตััะฒะธัะฐ',
                author='ะัะตะฟะพะดะพะฑะฝัะน ะะพะฐะฝะฝ ะะตััะฒะธัะฝะธะบ',
                chapter_number=28,
                verse_number=1,
                original_text='ะะพะปะธัะฒะฐ ะตััั ะฒะพะทะฝะพัะตะฝะธะต ัะผะฐ ะบ ะะพะณั.',
                translation_ru='ะะพะปะธัะฒะฐ ะตััั ะฒะพะทะฝะพัะตะฝะธะต ัะผะฐ ะบ ะะพะณั.',
                commentary='ะัะฐัะบะพะต ะพะฟัะตะดะตะปะตะฝะธะต ะผะพะปะธัะฒั.',
                theme='ะะพะปะธัะฒะฐ'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะกะฒััะพะพัะตัะตัะบะธะต ัััะดั',
                book_name='ะะตััะฒะธัะฐ',
                author='ะัะตะฟะพะดะพะฑะฝัะน ะะพะฐะฝะฝ ะะตััะฒะธัะฝะธะบ',
                chapter_number=28,
                verse_number=2,
                original_text='ะะพะปะธัะฒะฐ ะตััั ะผะฐัะตัั ะธ ะดะพัั ัะปะตะท.',
                translation_ru='ะะพะปะธัะฒะฐ ะตััั ะผะฐัะตัั ะธ ะดะพัั ัะปะตะท.',
                commentary='ะกะฒัะทั ะผะพะปะธัะฒั ั ะฟะพะบะฐัะฝะธะตะผ.',
                theme='ะะพะปะธัะฒะฐ'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะกะฒััะพะพัะตัะตัะบะธะต ัััะดั',
                book_name='ะ ะกะฒััะพะผ ะััะต',
                author='ะกะฒััะธัะตะปั ะะฐัะธะปะธะน ะะตะปะธะบะธะน',
                chapter_number=1,
                verse_number=1,
                original_text='ะัั ะกะฒััะพะน ะตััั ะธััะพัะฝะธะบ ะพัะฒััะตะฝะธั.',
                translation_ru='ะัั ะกะฒััะพะน ะตััั ะธััะพัะฝะธะบ ะพัะฒััะตะฝะธั.',
                commentary='ะะพะปั ะกะฒััะพะณะพ ะััะฐ ะฒ ะพัะฒััะตะฝะธะธ.',
                theme='ะกะฒััะพะน ะัั'
            ),
            
            # ะะพะณะผะฐัะธะบะฐ
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะพะณะผะฐัะธะบะฐ',
                book_name='ะัะฐะฒะพัะปะฐะฒะฝะพะต ะดะพะณะผะฐัะธัะตัะบะพะต ะฑะพะณะพัะปะพะฒะธะต',
                author='ะัะพัะพะฟัะตัะฒะธัะตั ะะธัะฐะธะป ะะพะผะฐะทะฐะฝัะบะธะน',
                chapter_number=1,
                verse_number=1,
                original_text='ะะพะณ ะตััั ะัั, ะธ ะฟะพะบะปะพะฝัััะธะตัั ะะผั ะดะพะปะถะฝั ะฟะพะบะปะพะฝััััั ะฒ ะดััะต ะธ ะธััะธะฝะต.',
                translation_ru='ะะพะณ ะตััั ะัั, ะธ ะฟะพะบะปะพะฝัััะธะตัั ะะผั ะดะพะปะถะฝั ะฟะพะบะปะพะฝััััั ะฒ ะดััะต ะธ ะธััะธะฝะต.',
                commentary='ะัะธัะพะดะฐ ะะพะณะฐ ะธ ะฟะพะบะปะพะฝะตะฝะธั.',
                theme='ะะพะณ'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะพะณะผะฐัะธะบะฐ',
                book_name='ะัะฐะฒะพัะปะฐะฒะฝะพะต ะดะพะณะผะฐัะธัะตัะบะพะต ะฑะพะณะพัะปะพะฒะธะต',
                author='ะัะพัะพะฟัะตัะฒะธัะตั ะะธัะฐะธะป ะะพะผะฐะทะฐะฝัะบะธะน',
                chapter_number=2,
                verse_number=1,
                original_text='ะขัะพะธัะฐ ะตััั ะตะดะธะฝัะน ะะพะณ ะฒ ััะตั ะะธัะฐั.',
                translation_ru='ะขัะพะธัะฐ ะตััั ะตะดะธะฝัะน ะะพะณ ะฒ ััะตั ะะธัะฐั.',
                commentary='ะะพะณะผะฐั ะพ ะกะฒััะพะน ะขัะพะธัะต.',
                theme='ะขัะพะธัะฐ'
            ),
            
            # ะขะตะบััั ะพ ัะตะผัะต ะธ ะพัะฝะพัะตะฝะธัั
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะธะฑะปะธั',
                book_name='ะะฒะฐะฝะณะตะปะธะต ะพั ะะฐััะตั',
                chapter_number=18,
                verse_number=21,
                original_text='ะขะพะณะดะฐ ะะตัั ะฟัะธัััะฟะธะป ะบ ะะตะผั ะธ ัะบะฐะทะฐะป: ะะพัะฟะพะดะธ! ัะบะพะปัะบะพ ัะฐะท ะฟัะพัะฐัั ะฑัะฐัั ะผะพะตะผั, ัะพะณัะตัะฐััะตะผั ะฟัะพัะธะฒ ะผะตะฝั? ะดะพ ัะตะผะธ ะปะธ ัะฐะท?',
                translation_ru='ะขะพะณะดะฐ ะะตัั ะฟัะธัััะฟะธะป ะบ ะะตะผั ะธ ัะบะฐะทะฐะป: ะะพัะฟะพะดะธ! ัะบะพะปัะบะพ ัะฐะท ะฟัะพัะฐัั ะฑัะฐัั ะผะพะตะผั, ัะพะณัะตัะฐััะตะผั ะฟัะพัะธะฒ ะผะตะฝั? ะดะพ ัะตะผะธ ะปะธ ัะฐะท?',
                commentary='ะะพะฟัะพั ะพ ะฟัะพัะตะฝะธะธ ะฒ ัะตะผัะต.',
                theme='ะัะพัะตะฝะธะต'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะธะฑะปะธั',
                book_name='ะะฒะฐะฝะณะตะปะธะต ะพั ะะฐััะตั',
                chapter_number=18,
                verse_number=22,
                original_text='ะะธััั ะณะพะฒะพัะธั ะตะผั: ะฝะต ะณะพะฒะพัั ัะตะฑะต: ะดะพ ัะตะผะธ ัะฐะท, ะฝะพ ะดะพ ัะตะดะผะธะถะดั ัะตะผะธะดะตัััะธ ัะฐะท.',
                translation_ru='ะะธััั ะณะพะฒะพัะธั ะตะผั: ะฝะต ะณะพะฒะพัั ัะตะฑะต: ะดะพ ัะตะผะธ ัะฐะท, ะฝะพ ะดะพ ัะตะดะผะธะถะดั ัะตะผะธะดะตัััะธ ัะฐะท.',
                commentary='ะะตัะบะพะฝะตัะฝะพะต ะฟัะพัะตะฝะธะต.',
                theme='ะัะพัะตะฝะธะต'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะธะฑะปะธั',
                book_name='ะะพัะปะฐะฝะธะต ะบ ะัะตััะฝะฐะผ',
                chapter_number=4,
                verse_number=26,
                original_text='ะะฝะตะฒะฐััั, ะฝะต ัะพะณัะตัะฐะนัะต: ัะพะปะฝัะต ะดะฐ ะฝะต ะทะฐะนะดะตั ะฒะพ ะณะฝะตะฒะต ะฒะฐัะตะผ.',
                translation_ru='ะะฝะตะฒะฐััั, ะฝะต ัะพะณัะตัะฐะนัะต: ัะพะปะฝัะต ะดะฐ ะฝะต ะทะฐะนะดะตั ะฒะพ ะณะฝะตะฒะต ะฒะฐัะตะผ.',
                commentary='ะ ะณะฝะตะฒะต ะธ ะฟัะพัะตะฝะธะธ.',
                theme='ะะฝะตะฒ'
            ),
            OrthodoxText(
                document_id=doc.id,
                confession='orthodox',
                source_type='ะะธะฑะปะธั',
                book_name='ะะพัะปะฐะฝะธะต ะบ ะัะตััะฝะฐะผ',
                chapter_number=4,
                verse_number=32,
                original_text='ะะพ ะฑัะดััะต ะดััะณ ะบะพ ะดััะณั ะดะพะฑัั, ัะพัััะฐะดะฐัะตะปัะฝั, ะฟัะพัะฐะนัะต ะดััะณ ะดััะณะฐ, ะบะฐะบ ะธ ะะพะณ ะฒะพ ะฅัะธััะต ะฟัะพััะธะป ะฒะฐั.',
                translation_ru='ะะพ ะฑัะดััะต ะดััะณ ะบะพ ะดััะณั ะดะพะฑัั, ัะพัััะฐะดะฐัะตะปัะฝั, ะฟัะพัะฐะนัะต ะดััะณ ะดััะณะฐ, ะบะฐะบ ะธ ะะพะณ ะฒะพ ะฅัะธััะต ะฟัะพััะธะป ะฒะฐั.',
                commentary='ะัะธะทัะฒ ะบ ะฟัะพัะตะฝะธั ะฒ ัะตะผัะต.',
                theme='ะัะพัะตะฝะธะต'
            ),
        ]
        
        for text in extended_orthodox_texts:
            # ะัะพะฒะตััะตะผ, ะฝะต ัััะตััะฒัะตั ะปะธ ัะถะต ัะฐะบะพะน ัะตะบัั
            existing = self.db.query(OrthodoxText).filter(
                OrthodoxText.book_name == text.book_name,
                OrthodoxText.chapter_number == text.chapter_number,
                OrthodoxText.verse_number == text.verse_number,
                OrthodoxText.confession == text.confession
            ).first()
            
            if not existing:
                self.db.add(text)
                self.loaded_count += 1
        
        self.db.commit()
        logger.info(f"โ ะะฐะณััะถะตะฝะพ {len(extended_orthodox_texts)} ะฟัะฐะฒะพัะปะฐะฒะฝัั ัะตะบััะพะฒ")
    
    def close(self):
        """ะะฐะบััะฒะฐะตั ัะพะตะดะธะฝะตะฝะธะต ั ะฑะฐะทะพะน ะดะฐะฝะฝัั"""
        self.db.close()

def main():
    """ะัะฝะพะฒะฝะฐั ััะฝะบัะธั"""
    loader = ProductionDataLoader()
    try:
        loader.load_extended_sample_data()
        logger.info("๐ ะะฐััะธัะตะฝะฝัะต ะดะฐะฝะฝัะต ััะฟะตัะฝะพ ะทะฐะณััะถะตะฝั!")
    except Exception as e:
        logger.error(f"โ ะัะธะฑะบะฐ ะทะฐะณััะทะบะธ ะดะฐะฝะฝัั: {e}")
    finally:
        loader.close()

if __name__ == "__main__":
    main()

# Настройка OpenAI API для LEGACY M

## Шаги настройки:

### 1. Получите API ключ OpenAI
- Перейдите на https://platform.openai.com/api-keys
- Войдите в свой аккаунт OpenAI
- Создайте новый API ключ

### 2. Настройте API ключ
Откройте файл `config.env` и замените:
```
OPENAI_API_KEY=your-openai-api-key-here
```
на ваш реальный API ключ:
```
OPENAI_API_KEY=sk-ваш-реальный-ключ-здесь
```

### 3. Загрузите переменные окружения
Перед запуском сервера выполните:
```bash
export OPENAI_API_KEY="sk-ваш-реальный-ключ-здесь"
```

Или добавьте в ваш `.bashrc` или `.zshrc`:
```bash
echo 'export OPENAI_API_KEY="sk-ваш-реальный-ключ-здесь"' >> ~/.zshrc
source ~/.zshrc
```

### 4. Перезапустите сервер
```bash
cd /Users/kamong/telegram_ai_assistant/legacy_m
python3 backend/main.py
```

## Что изменилось:

- ✅ ИИ теперь использует OpenAI GPT-3.5-turbo для генерации ответов
- ✅ Ответы стали короче и более естественными (максимум 200 токенов)
- ✅ ИИ отвечает как живой собеседник, а не как робот
- ✅ Сохраняется привязка к источникам из базы данных
- ✅ Если OpenAI недоступен, используется fallback режим

## Примеры улучшений:

**Было:** Длинный технический ответ с полным текстом аятов
**Стало:** "В Коране, сура 2, аят 255 говорится о том, что Аллах - единственный Бог. Пост - это испытание веры, и если очень хочется сорваться, помните: Аллах не возлагает на душу больше, чем она может вынести. Рекомендую обратиться к имаму для духовной поддержки."

Теперь ИИ будет отвечать кратко, по существу и как живой собеседник!
